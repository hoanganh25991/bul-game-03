<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Game</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #f0f0f0;
            margin: 20px;
        }
        canvas {
            border: 2px solid #333;
            background: #2d3748;
        }
        .stats {
            margin: 10px 0;
            padding: 10px;
            background: white;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <h1>üó°Ô∏è Test Game</h1>
    
    <div class="stats">
        <span>C·∫•p ƒë·ªô: <span id="player-level">1</span></span> |
        <span>M√°u: <span id="player-hp">100</span></span> |
        <span>V√†ng: <span id="player-gold">0</span></span>
    </div>
    
    <canvas id="gameCanvas" width="600" height="400"></canvas>
    
    <div style="margin-top: 10px;">
        <p>Nh·∫•n WASD ƒë·ªÉ di chuy·ªÉn, SPACE ƒë·ªÉ t·∫•n c√¥ng</p>
        <button id="heal-btn">üß™ H·ªìi m√°u</button>
    </div>
    
    <div id="game-log" style="margin-top: 10px; padding: 10px; background: white; height: 100px; overflow-y: auto;">
        <p>Game ƒë√£ kh·ªüi t·∫°o!</p>
    </div>

    <script>
        // Game state ƒë∆°n gi·∫£n
        const gameState = {
            player: {
                x: 300,
                y: 200,
                level: 1,
                hp: 100,
                maxHp: 100,
                gold: 0,
                isAttacking: false,
                attackTimer: 0
            },
            enemies: []
        };

        // Canvas
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');

        // Kh·ªüi t·∫°o
        function init() {
            console.log("Game kh·ªüi t·∫°o!");
            addToLog("Ch√†o m·ª´ng ƒë·∫øn v·ªõi Test Game!");
            
            // T·∫°o v√†i qu√°i v·∫≠t
            for (let i = 0; i < 3; i++) {
                gameState.enemies.push({
                    x: Math.random() * 500 + 50,
                    y: Math.random() * 300 + 50,
                    hp: 50,
                    color: '#ff6b6b'
                });
            }
            
            gameLoop();
            setupControls();
        }

        // Game loop
        function gameLoop() {
            // X√≥a canvas
            ctx.fillStyle = '#2d3748';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // V·∫Ω l∆∞·ªõi
            ctx.strokeStyle = '#4a5568';
            ctx.lineWidth = 1;
            for (let x = 0; x < canvas.width; x += 40) {
                ctx.beginPath();
                ctx.moveTo(x, 0);
                ctx.lineTo(x, canvas.height);
                ctx.stroke();
            }
            
            // V·∫Ω ng∆∞·ªùi ch∆°i
            drawPlayer();
            
            // V·∫Ω qu√°i v·∫≠t
            gameState.enemies.forEach(enemy => {
                ctx.fillStyle = enemy.color;
                ctx.beginPath();
                ctx.arc(enemy.x, enemy.y, 12, 0, 2 * Math.PI);
                ctx.fill();
            });
            
            // C·∫≠p nh·∫≠t timer t·∫•n c√¥ng
            if (gameState.player.attackTimer > 0) {
                gameState.player.attackTimer--;
                if (gameState.player.attackTimer <= 0) {
                    gameState.player.isAttacking = false;
                }
            }
            
            requestAnimationFrame(gameLoop);
        }

        // V·∫Ω ng∆∞·ªùi ch∆°i
        function drawPlayer() {
            const player = gameState.player;
            
            // V·∫Ω g·∫≠y ph√©p n·∫øu ƒëang t·∫•n c√¥ng
            if (player.isAttacking) {
                // Th√¢n g·∫≠y
                ctx.strokeStyle = '#8B4513';
                ctx.lineWidth = 4;
                ctx.beginPath();
                ctx.moveTo(player.x + 20, player.y - 10);
                ctx.lineTo(player.x + 20, player.y + 20);
                ctx.stroke();
                
                // ƒê·∫ßu g·∫≠y ph√©p
                ctx.fillStyle = '#9932CC';
                ctx.beginPath();
                ctx.moveTo(player.x + 20, player.y - 20);
                ctx.lineTo(player.x + 15, player.y - 10);
                ctx.lineTo(player.x + 20, player.y - 5);
                ctx.lineTo(player.x + 25, player.y - 10);
                ctx.closePath();
                ctx.fill();
                
                // Qu·∫£ c·∫ßu nƒÉng l∆∞·ª£ng si√™u ƒë·∫πp!
                const energyX = player.x + 20;
                const energyY = player.y - 12;
                const time = Date.now() * 0.01;
                
                // L·ªõp ngo√†i - √°nh s√°ng m·ªù
                ctx.fillStyle = 'rgba(0, 255, 255, 0.3)';
                ctx.beginPath();
                ctx.arc(energyX, energyY, 12 + Math.sin(time) * 2, 0, 2 * Math.PI);
                ctx.fill();
                
                // L·ªõp gi·ªØa - nƒÉng l∆∞·ª£ng ch√≠nh
                ctx.fillStyle = 'rgba(0, 200, 255, 0.7)';
                ctx.beginPath();
                ctx.arc(energyX, energyY, 8 + Math.sin(time * 1.5) * 1, 0, 2 * Math.PI);
                ctx.fill();
                
                // L√µi nƒÉng l∆∞·ª£ng - s√°ng nh·∫•t
                ctx.fillStyle = 'rgba(255, 255, 255, 0.9)';
                ctx.beginPath();
                ctx.arc(energyX, energyY, 4 + Math.sin(time * 2) * 0.5, 0, 2 * Math.PI);
                ctx.fill();
                
                // Tia s√°ng xung quanh
                ctx.strokeStyle = '#00FFFF';
                ctx.lineWidth = 2;
                for (let i = 0; i < 8; i++) {
                    const angle = (i * Math.PI) / 4 + time * 0.5;
                    const startX = energyX + Math.cos(angle) * 6;
                    const startY = energyY + Math.sin(angle) * 6;
                    const endX = energyX + Math.cos(angle) * (18 + Math.sin(time + i) * 3);
                    const endY = energyY + Math.sin(angle) * (18 + Math.sin(time + i) * 3);
                    
                    ctx.beginPath();
                    ctx.moveTo(startX, startY);
                    ctx.lineTo(endX, endY);
                    ctx.stroke();
                }
                
                // H·∫°t nƒÉng l∆∞·ª£ng bay xung quanh
                for (let i = 0; i < 6; i++) {
                    const particleAngle = time * 2 + (i * Math.PI) / 3;
                    const particleRadius = 25 + Math.sin(time + i) * 5;
                    const particleX = energyX + Math.cos(particleAngle) * particleRadius;
                    const particleY = energyY + Math.sin(particleAngle) * particleRadius;
                    
                    ctx.fillStyle = `rgba(0, 255, 255, ${0.8 - (i * 0.1)})`;
                    ctx.beginPath();
                    ctx.arc(particleX, particleY, 2, 0, 2 * Math.PI);
                    ctx.fill();
                }
            }
            
            // V·∫Ω ng∆∞·ªùi ch∆°i
            ctx.fillStyle = '#4299e1';
            ctx.beginPath();
            ctx.arc(player.x, player.y, 15, 0, 2 * Math.PI);
            ctx.fill();
            
            // V·∫Ω m·∫Øt
            ctx.fillStyle = 'white';
            ctx.beginPath();
            ctx.arc(player.x - 5, player.y - 3, 3, 0, 2 * Math.PI);
            ctx.fill();
            ctx.beginPath();
            ctx.arc(player.x + 5, player.y - 3, 3, 0, 2 * Math.PI);
            ctx.fill();
            
            ctx.fillStyle = 'black';
            ctx.beginPath();
            ctx.arc(player.x - 5, player.y - 3, 1, 0, 2 * Math.PI);
            ctx.fill();
            ctx.beginPath();
            ctx.arc(player.x + 5, player.y - 3, 1, 0, 2 * Math.PI);
            ctx.fill();
        }

        // ƒêi·ªÅu khi·ªÉn
        const keys = {};
        
        function setupControls() {
            document.addEventListener('keydown', (e) => {
                keys[e.key.toLowerCase()] = true;
                
                if (e.key === ' ') {
                    e.preventDefault();
                    // K√≠ch ho·∫°t hi·ªáu ·ª©ng t·∫•n c√¥ng
                    gameState.player.isAttacking = true;
                    gameState.player.attackTimer = 60; // 1 gi√¢y
                    addToLog("T·∫•n c√¥ng v·ªõi g·∫≠y ph√©p!");
                    console.log("T·∫•n c√¥ng!");
                }
            });
            
            document.addEventListener('keyup', (e) => {
                keys[e.key.toLowerCase()] = false;
            });
            
            // Di chuy·ªÉn
            setInterval(() => {
                const speed = 3;
                if (keys['w'] || keys['arrowup']) gameState.player.y -= speed;
                if (keys['s'] || keys['arrowdown']) gameState.player.y += speed;
                if (keys['a'] || keys['arrowleft']) gameState.player.x -= speed;
                if (keys['d'] || keys['arrowright']) gameState.player.x += speed;
                
                // Gi·ªõi h·∫°n
                gameState.player.x = Math.max(20, Math.min(canvas.width - 20, gameState.player.x));
                gameState.player.y = Math.max(20, Math.min(canvas.height - 20, gameState.player.y));
            }, 16);
        }

        // Log
        function addToLog(message) {
            const log = document.getElementById('game-log');
            const p = document.createElement('p');
            p.textContent = new Date().toLocaleTimeString() + ': ' + message;
            log.appendChild(p);
            log.scrollTop = log.scrollHeight;
        }

        // Kh·ªüi t·∫°o khi trang load
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>